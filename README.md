# AtCoder Stats Bot

DiscordのチャットログからAtCoderの精進記録を集計し、グラフ化するボットです。
Koyebなどのクラウドサービスで24時間稼働させることを想定して設計されています。

### 📝 入力形式（集計ルール）

ボットは、メッセージの**各行の先頭**を見て自動的にカテゴリを判定し、集計します。

| カテゴリ | 書き方の例 | 説明 |
| :--- | :--- | :--- |
| **ABC/ARC/AGC** | `ABC300 A B C` | コンテスト名 + 回数 + 問題記号。<br>小文字 (`abc`) や `Ex` も自動で判定されます。 |
| **鉄則本** | `鉄則本 A01 B01` | 先頭に「鉄則」が含まれていればOK。<br>後ろに続く単語の数を問題数としてカウントします。 |
| **典型90問** | `典型90 001 002` | 先頭に「典型」が含まれていればOK。<br>後ろに続く単語の数をカウントします。 |
| **その他** | `企業コン A B` | 上記のルールに当てはまらないものは、すべて「Others」として集計されます。 |

> 💡 **ポイント**: 1つのメッセージに複数行書いても、行ごとに正しく集計されます。

### ⚙️ コマンドと機能

| コマンド | 機能 |
| :--- | :--- |
| `/atcoder` | **全期間**の精進記録を集計して表示します。 |
| `/atcoder week` | **直近1週間**の記録のみを集計します。週間目標の確認に便利です。 |
| `/atcoder @ユーザー` | 指定した**他のメンバー**の記録を表示します。 |
| `/atcoder range 2026-01-01 2026-01-31` | **指定した期間**（開始日〜終了日）の記録を表示します。 |

**実行結果として表示されるもの:**
1. **Activityグラフ**: 日ごとのAC数（棒グラフ）と、累積AC数（折れ線グラフ）。
2. **Difficulty分布**: 解いた問題の難易度分布（ヒストグラム）。AtCoderの色（灰、茶、緑...）で色分けされます。
3. **集計表**: コンテスト種別ごとの正解数一覧表。

### 🚀 デプロイ方法 (Koyeb)

1. このリポジトリをGitHubにプッシュ（またはフォーク）します。
2. [Koyeb](https://www.koyeb.com/) で新しい **Service** を作成します。
3. **GitHub** をソースとして選択し、このリポジトリを選びます。
4. **Builder** は "Buildpack" を選択します。
5. **Service type** は **"Web service"** を選択します。
6. **Environment Variables** (環境変数) を設定します:
   * `DISCORD_TOKEN`: Discord Developer Portalで取得したトークン。
   * `TARGET_CHANNEL_ID`: ボットを動かすチャンネルのID（数字）。
7. **Run command** (実行コマンド) を設定します:
   ```bash
   python atcoder_bot.py
   ```
8. デプロイを実行します。